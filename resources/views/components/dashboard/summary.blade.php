<div class="container-fluid">
    <div class="row">

        <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 col-12 animated fadeIn p-2">
            <div class="card card-plain h-100 bg-white">
                <div class="p-3">
                    <div class="row">
                        <div class="col-9 col-lg-8 col-md-8 col-sm-9">
                            <div>
                                <h5 class="mb-0 text-capitalize font-weight-bold">
                                    <span id="product"></span>
                                </h5>
                                <p class="mb-0 text-sm">Product</p>
                            </div>
                        </div>
                        <div class="col-3 col-lg-4 col-md-4 col-sm-3 text-end">
                            <div class="icon icon-shape bg-gradient-primary shadow float-end border-radius-md">
                                <img class="w-100 " src="{{ asset('images/icon.svg') }}" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 col-12 animated fadeIn p-2">
            <div class="card card-plain h-100 bg-white">
                <div class="p-3">
                    <div class="row">
                        <div class="col-9 col-lg-8 col-md-8 col-sm-9">
                            <div>
                                <h5 class="mb-0 text-capitalize font-weight-bold">
                                    <span id="category"></span>
                                </h5>
                                <p class="mb-0 text-sm">Category</p>
                            </div>
                        </div>
                        <div class="col-3 col-lg-4 col-md-4 col-sm-3 text-end">
                            <div class="icon icon-shape bg-gradient-primary shadow float-end border-radius-md">
                                <img class="w-100 " src="{{ asset('images/icon.svg') }}" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 col-12 animated fadeIn p-2">
            <div class="card card-plain h-100 bg-white">
                <div class="p-3">
                    <div class="row">
                        <div class="col-9 col-lg-8 col-md-8 col-sm-9">
                            <div>
                                <h5 class="mb-0 text-capitalize font-weight-bold">
                                    <span id="customer"></span>
                                </h5>
                                <p class="mb-0 text-sm">Customer</p>
                            </div>
                        </div>
                        <div class="col-3 col-lg-4 col-md-4 col-sm-3 text-end">
                            <div class="icon icon-shape bg-gradient-primary shadow float-end border-radius-md">
                                <img class="w-100 " src="{{ asset('images/icon.svg') }}" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 col-12 animated fadeIn p-2">
            <div class="card card-plain h-100  bg-white">
                <div class="p-3">
                    <div class="row">
                        <div class="col-9 col-lg-8 col-md-8 col-sm-9">
                            <div>
                                <h5 class="mb-0 text-capitalize font-weight-bold">
                                    <span id="invoice"></span>
                                </h5>
                                <p class="mb-0 text-sm">Invoice</p>
                            </div>
                        </div>
                        <div class="col-3 col-lg-4 col-md-4 col-sm-3 text-end">
                            <div class="icon icon-shape bg-gradient-primary shadow float-end border-radius-md">
                                <img class="w-100 " src="{{ asset('images/icon.svg') }}" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 col-12 animated fadeIn p-2">
            <div class="card card-plain h-100 bg-white">
                <div class="p-3">
                    <div class="row">
                        <div class="col-9 col-lg-8 col-md-8 col-sm-9">
                            <div>
                                <h5 class="mb-0 text-capitalize font-weight-bold">
                                    $ <span id="total"></span>
                                </h5>
                                <p class="mb-0 text-sm">Total Sale</p>
                            </div>
                        </div>
                        <div class="col-3 col-lg-4 col-md-4 col-sm-3 text-end">
                            <div class="icon icon-shape bg-gradient-primary shadow float-end border-radius-md">
                                <img class="w-100 " src="{{ asset('images/icon.svg') }}" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 col-12 animated fadeIn p-2">
            <div class="card card-plain h-100  bg-white">
                <div class="p-3">
                    <div class="row">
                        <div class="col-9 col-lg-8 col-md-8 col-sm-9">
                            <div>
                                <h5 class="mb-0 text-capitalize font-weight-bold">
                                    $ <span id="payable"></span>
                                </h5>
                                <p class="mb-0 text-sm">Total Collection</p>
                            </div>
                        </div>
                        <div class="col-3 col-lg-4 col-md-4 col-sm-3 text-end">
                            <div class="icon icon-shape bg-gradient-primary shadow float-end border-radius-md">
                                <img class="w-100 " src="{{ asset('images/icon.svg') }}" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 col-12 animated fadeIn p-2">
            <div class="card card-plain h-100  bg-white">
                <div class="p-3">
                    <div class="row">
                        <div class="col-9 col-lg-8 col-md-8 col-sm-9">
                            <div>
                                <h5 class="mb-0 text-capitalize font-weight-bold">
                                    $ <span id="vat"></span>
                                </h5>
                                <p class="mb-0 text-sm">Vat Collection</p>
                            </div>
                        </div>
                        <div class="col-3 col-lg-4 col-md-4 col-sm-3 text-end">
                            <div class="icon icon-shape bg-gradient-primary shadow float-end border-radius-md">
                                <img class="w-100 " src="{{ asset('images/icon.svg') }}" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 col-12 animated fadeIn p-2">
            <div class="card card-plain h-100  bg-white">
                <div class="p-3">
                    <div class="row">
                        <div class="col-9 col-lg-8 col-md-8 col-sm-9">
                            <div>
                                <h5 class="mb-0 text-capitalize font-weight-bold">
                                    $ <span id="discount"></span>
                                </h5>
                                <p class="mb-0 text-sm">Total Discount</p>
                            </div>
                        </div>
                        <div class="col-3 col-lg-4 col-md-4 col-sm-3 text-end">
                            <div class="icon icon-shape bg-gradient-primary shadow float-end border-radius-md">
                                <img class="w-100 " src="{{ asset('images/icon.svg') }}" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="row pt-5">
        <div class="col-lg-6 col-md-12 col-sm-12">
            <canvas id="chart_day_sell" style="width:100%;max-width:900px"></canvas>
        </div>
        <div class="col-lg-6 col-md-12 col-sm-12">

            <canvas id="chart_top_sell" style="width:100%;max-width:900px"></canvas>
        </div>
    </div>
</div>



<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script> {{-- for pie chart --}}
<script>
    getList();

    function getList() {
        showLoader();
        $.ajax({
            type: "get",
            url: "/summary",
            success: function(res) {
                // console.log(res.data['total'][0]);
                hideLoader();
                if (res.status == '200') {
                    $('#product').text((res.data['product']));
                    $('#invoice').text(res.data['invoice']);
                    $('#category').text(res.data['category']);
                    $('#customer').text(res.data['customer']);
                    $('#total').text(res.data['total'][0]['total_sell'].toFixed(2));
                    $('#vat').text(res.data['total'][0]['total_vat'].toFixed(2));
                    $('#payable').text(res.data['total'][0]['total_payable'].toFixed(2));
                    $('#discount').text(res.data['total'][0]['total_discount'].toFixed(2));


                    SellbyDay(res); //chart_day_sell
                    topSellProduct(res); //chart_top_sell


                } else {
                    console.log(res);
                    errorToast(res.message);
                }
            },
            error: function(err) {
                hideLoader();
                console.log(err.responseJSON);
                errorToast('Something went wrong');
            }
        })
        // }


        // pieChart()

        // function pieChart() {
        function SellbyDay(res) {
            month = [];
            var totalSell = [];
            res.data['sellByMonthThisYear'].forEach(data => {
                month.push(data.month);
                totalSell.push(data.total_collection.toFixed());
            });
            // console.log(totalSell);
            new Chart($("#chart_day_sell"), {
                type: 'bar',
                data: {
                    labels: month,
                    datasets: [{
                        label: "Sell",
                        data: totalSell,
                        backgroundColor: '#6433c0',
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    },
                    legend: {
                        display: true,
                        position: 'bottom',
                    },
                    title: {
                        display: true,
                        text: "This Year Monthly Sell",
                        fontSize: 20,
                        fontColor: "#111",
                        position: 'top',

                    },

                }

            })
        }

        function topSellProduct(res) {
            var xValues = [];
            var yValues = [];
            res.data['topSellingProduct'].forEach(products => {
                xValues.push(products.product.name);
                yValues.push(products.total_qty);
            });
            var barColors = [
                "#a260ff ",
                "#28025c",
                "#008DDA",
                "#41C9E2",
                "#824D74",
                "#FF8E8F",
                "#FFC700",
                "#F6995C",
                "#FF204E",
                "#ea0606",
            ];


            new Chart($("#chart_top_sell"), {
                type: "doughnut",
                data: {
                    labels: xValues,
                    datasets: [{
                        backgroundColor: barColors,
                        data: yValues
                    }],
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,

                    title: {
                        display: true,
                        text: "Top Selling Products",
                        fontSize: 20,
                        fontColor: "#111",
                        position: 'top',
                    },
                    legend: {
                        position: 'bottom',
                    },
                }
            });
        }


    }
</script>
